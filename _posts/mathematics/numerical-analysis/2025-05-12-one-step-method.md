---
title: "One-step Method"
toc: true
author: bluehorn_math
toc_sticky: true
categories: ["Numerical Analysis"]
excerpt: "오일러 방법을 개선한 후방 오일러 방법과 사다리꼴 방법. 그리고 이 방식들의 오차와 정확도에 대해서."
---

수학과 복수전공을 위해 졸업 마지막 학기에 "수치해석개론" 수업을 듣게 되었습니다. 수학과 졸업시험도 겸사겸사 준비할 겸 화이팅 해봅시다!! 전체 포스트는 "[Numerical Analysis](/categories/numerical-analysis)"에서 확인할 수 있습니다.
{: .notice }

# 들어가며

## Backward Euler Method

오일러 방법에서는 미분방정식을 기울기 근사를 통해 아래와 같이 표현하였습니다.

$$
\frac{u_{n+1} - u_n}{k} = f(t_n, u_n)
$$

이번에는 이것을 바꿔서 아래와 같이 적어보겠습니다!

$$
\frac{u_{n+1} - u_n}{k} = f({\color{red}t_{n+1}}, {\color{red}u_{n+1}})
$$

좌변은 동일하지만, 우변에서 $n$ 스텝의 값이 아니라 $(n+1)$ 스텝의 값을 사용합니다!

먼저 살펴본 오일러 방식과 이를 구분하기 위해 먼저 살펴본 것을 "전진 오일러 방법", 이번 것을 "우힌 오일러 방법"이라고 표현 하겠습니다.

그리고 이 식을 정리하면,

$$
u_{n+1} = u_n + k f(t_{n+1}, u_{n+1})
$$

위의 식은 양변에 $u_{n+1}$가 존재하는 "implicit" 폼을 가집니다. 이것을 풀기 위해서는 방정식의 해를 찾아야 합니다. 그래서 식을 다시 $g(u)$로 정리합니다.

$$
g(u) = u - k f(t_{n+1}, u) - u_n = 0
$$

어라? 이것 좀 익숙한 형태 입니다! ㅎㅎ 바로 수치해석 수업의 전반부에 나왔던 "root-finding" 방식인 "뉴턴 방법" 입니다!

반복법을 사용해서 $g(u) = 0$을 만족하는 $u$를 찾으면, 그것이 $u_{n+1}$의 값이 됩니다!

<br/>

전진 오일러 방식과 비교하면, 후진 오일러 방식은 $u_{n+1}$를 구하는 과정이 복잡해보입니다. 딱 봐도 $g(u) = 0$을 구해야 하기 때문에 계산량이 더 많고, 구현이 복잡 합니다.

하지만, 전진 오일러에 비해 후진 오일러 방식이 더 안정적이고, 전진 오일러 방식이 갖는 stiff 문제에 강건하다고 합니다.

## Trapezoid Method

이번에는 전진 오일러와 후진 오일러 방식의 평균을 사용하는 "implicit" 방식 입니다.

$$
\frac{u_{n+1} - u_n}{k} = \frac{f(t_n, u_n) + f(t_{n+1}, u_{n+1})}{2}
$$

수식을 정리하면,

$$
u_{n+1} = u_n + \frac{k}{2} \left( f(t_n, u_n) + f(t_{n+1}, u_{n+1}) \right)
$$

이때도 $u_{n+1}$이 양변에 포함되어 있기 때문에, root-finding으로 방정식을 풀어야 합니다.


# One-step Method

지금까지 살펴본, 전진 오일러 방식, 후진 오일러 방식, 사다리꼴 방식 모두 $u_{n+1}$를 계산하기 위해 바로 직전 값인 $u_n$ 만을 사용했습니다. 이것보다 과거의 더 이전 값들은 필요하지 않습니다.

그래서 이 3가지 방식을 모두 "**one-step**" method 라고 부릅니다!

지금까지 살펴본 one-step method의 수식을 일반화 하면 아래와 같습니다.

$$
u_{n+1} = u_n + k \Phi
$$

이때, $\Phi$는 어던 함수로 각 방법마다 다르게 정의 됩니다.

- 전진 오일러
  - $\Phi = f(t_n, u_n)$
- 후진 오일러
  - $\Phi= f(t_{n+1}, u_{n+1})$
- 사다리꼴 방법
  - $\Phi = (f(t_n, u_n) + f(t_{n+1}, u_{n+1}))/2$

# Consistent btw Numerical and Analytical

수치적 방법으로 구한 솔루션이 해석적 방법으로 구한 솔루션과 일치(consistent)하게 되기 위해서는 아래의 조건이 필요 합니다.

As $k \rightarrow 0$, $\tau_n \rightarrow 0$

즉, 시간의 간격 $k$를 줄일 수록 오차도 함께 줄어들어야 합니다.

# Order of Accuracy

국소 오차의 오차 정확도는 아래와 같이 표현 합니다.

$$
\tau_n \approx C k^p
$$

라고 하면, 이 one-step method의 오차는 $p$가 됩니다.

전진/후진 오일러 방식은 오차 정확도가 $k^1$로 1차 정확도를 가집니다.

반면에, 사다리꼴 방식은 오차 정확도가 $k^2$로 2차 정확도를 가집니다.

# 맺음말

one-step method는 테일러 급수 전개에서 1차 항을 남겨서 수치적 접근을 했습니다.

만약, 더 많은 항을 남기면 어떻게 될까요? 왠지 더 정확한 수치적 솔루션을 얻을 것 같지 않나요? ㅎㅎ

다음 포스트에서는 이 아이디어를 기반으로 하는 "Taylor Method"에 대해 살펴봅니다!

